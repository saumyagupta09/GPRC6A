multiple-files: No

Analysis Description
--------------------
RELAX (a random effects test of selection relaxation) uses a random
effects branch-site model framework to test whether a set of 'Test'
branches evolves under relaxed selection relative to a set of
'Reference' branches (R), as measured by the relaxation parameter (K).
Version 2.1 adds a check for stability in K estimates to try to mitigate
convergence problems. Version 3 provides support for >2 branch sets.
Version 3.1 adds LHC + Nedler-Mead initial fit phase and keyword
support. Version 3.1.1 adds some bug fixes for better convergence.
Version 4.0 adds support for synonymous rate variation. Version 4.1 adds
further support for multiple hit models. Version 4.1.1 adds reporting
for convergence diagnostics. Version 4.5 adds support for multiple
datasets for joint testing.

- __Requirements__: in-frame codon alignment and a phylogenetic tree, with at least two
groups of branches defined using the {} notation (one group can be
defined as all unlabeled branches)

- __Citation__: RELAX: Detecting Relaxed Selection in a Phylogenetic Framework (2015).
Mol Biol Evol 32 (3): 820-832

- __Written by__: Sergei L Kosakovsky Pond, Ben Murrell, Steven Weaver and Temple iGEM /
UCSD viral evolution g

- __Contact Information__: spond@temple.edu

- __Analysis Version__: 4.5


>code => Universal

-------
>[WARNING]
'/media/ceglab27/Saumya/GPRC6A/HYPHY/Primates_Scandantia_Dermoptera/codon_alignment.phy'
contains 1 duplicate sequence. Identical sequences do not contribute any
information to the analysis and only slow down computation. Please
consider removing duplicate or 'nearly' duplicate sequences, e.g. using
https://github.com/veg/hyphy-analyses/tree/master/remove-duplicates
prior to running selection analyses
-------
/media/ceglab27/Saumya/GPRC6A/HYPHY/Primates_Scandantia_Dermoptera/Nomascus_leucogenys_labelled.nwk
Nomascus_leucogenys_labelled.nwk

>Loaded a multiple sequence alignment with **37** sequences, **929** codons, and **1** partitions from `/media/ceglab27/Saumya/GPRC6A/HYPHY/Primates_Scandantia_Dermoptera/codon_alignment.phy`

>test => fg
The number of points in the initial distributional guess for likelihood fitting (permissible range = [1,10000], default value = 250, integer): 
>grid-size => 250
The number of initial random guesses to 'seed' rate values optimization (permissible range = [1,25], default value = 1, integer): 
>starting-points => 1


### Branch sets for RELAX analysis

>multiple-hits => None

* Selected 70 branches as the _Reference_ set: `Aotus_nancymaae, Callithrix_jacchus, Carlito_syrichta, Cebus_imitator, Cercocebus_atys, Chlorocebus_sabaeus, Colobus_angolensis, Cynocephalus_volans, Eulemur_rufifrons, Galeopterus_variegatus, Gorilla_gorilla, Homo_sapiens, Hylobates_moloch, Lemur_catta, Macaca_fascicularis, Macaca_mulatta, Macaca_nemestrina, Macaca_thibetana, Mandrillus_leucophaeus, Microcebus_murinus, Node10, Node11, Node14, Node17, Node18, Node19, Node2, Node20, Node23, Node24, Node28, Node29, Node30, Node31, Node35, Node36, Node38, Node41, Node44, Node45, Node47, Node48, Node49, Node5, Node52, Node55, Node56, Node58, Node6, Node62, Node63, Node65, Node68, Node7, Nycticebus_coucang, Otolemur_garnettii, Pan_paniscus, Papio_anubis, Piliocolobus_tephrosceles, Pongo_abelii, Pongo_pygmaeus, Propithecus_coquereli, Rhinopithecus_bieti, Rhinopithecus_roxellana, Saimiri_boliviensis, Sapajus_apella, Symphalangus_syndactylus, Theropithecus_gelada, Trachypithecus_francoisi, Tupaia_chinensis`

* Selected 1 branches as the _Test_ set: `Nomascus_leucogenys`
The number omega rate classes to include in the model (permissible range = [2,10], default value = 3, integer): 
>rates => 3

>models => All

>srv => No


### Obtaining branch lengths and nucleotide substitution biases under the nucleotide GTR model

>kill-zero-lengths => Yes

### Deleted 1 zero-length internal branches: `Node23`
* Log(L) = -13700.57, AIC-c = 27559.27 (79 estimated parameters)
* 1 partition. Total tree length by partition (subs/site)  0.655

### Obtaining the global omega estimate based on relative GTR branch lengths and nucleotide substitution biases
* Log(L) = -13278.31, AIC-c = 26729.06 (86 estimated parameters)
* 1 partition. Total tree length by partition (subs/site)  0.673
* non-synonymous/synonymous rate ratio for *Reference* =   0.3212
* non-synonymous/synonymous rate ratio for *Test* =   0.4791

### Improving branch lengths, nucleotide substitution biases, and global dN/dS ratios under a full codon model
* Log(L) = -13250.52, AIC-c = 26673.47 (86 estimated parameters)
* 1 partition. Total tree length by partition (subs/site)  0.673
* non-synonymous/synonymous rate ratio for *Reference* =   0.2857
* non-synonymous/synonymous rate ratio for *Test* =   0.7242

### Fitting the general descriptive (separate k per branch) model

### * Log(L) = -13176.57, AIC-c = 26672.63 (159 estimated parameters)
* The following baseline rate distribution for branch-site combinations was inferred

|          Selection mode           |     dN/dS     |Proportion, %|               Notes               |
|-----------------------------------|---------------|-------------|-----------------------------------|
|        Negative selection         |     0.000     |    0.000    |       Not supported by data       |
|        Negative selection         |     0.000     |   91.667    |       Collapsed rate class        |
|      Diversifying selection       |    12.001     |    8.333    |                                   |


 ### Because some of the rate classes were collapsed to 0, the model is likely overparameterized. RELAX will reduce the number of site rate classes by one and repeat the fit now.
----

Fitting the general descriptive (separate k per branch) model
* Log(L) = -13174.84, AIC-c = 26665.12 (157 estimated parameters)
* The following baseline rate distribution for branch-site combinations was inferred

|          Selection mode           |     dN/dS     |Proportion, %|               Notes               |
|-----------------------------------|---------------|-------------|-----------------------------------|
|        Negative selection         |     0.000     |   88.710    |                                   |
|      Diversifying selection       |     8.858     |   11.290    |                                   |

* Branch-level relaxation or intensification parameter distribution has mean  0.40, median  0.08, and 95% of the weight in  0.01 -  2.64

### Fitting the alternative model to test K != 1
* Log(L) = -13226.95, AIC-c = 26636.38 (91 estimated parameters)
* Relaxation/intensification parameter (K) =     0.22
* The following rate distribution was inferred for **test** branches

|          Selection mode           |     dN/dS     |Proportion, %|               Notes               |
|-----------------------------------|---------------|-------------|-----------------------------------|
|        Negative selection         |     0.623     |   88.463    |                                   |
|      Diversifying selection       |     1.333     |    3.297    |                                   |
|      Diversifying selection       |     1.509     |    8.240    |                                   |

* The following rate distribution was inferred for **reference** branches

|          Selection mode           |     dN/dS     |Proportion, %|               Notes               |
|-----------------------------------|---------------|-------------|-----------------------------------|
|        Negative selection         |     0.121     |   88.463    |                                   |
|      Diversifying selection       |     1.078     |    8.240    |                                   |
|      Diversifying selection       |     3.603     |    3.297    |                                   |


### * Potential convergence issues due to flat likelihood surfaces; checking to see whether K > 1 or K < 1 is robustly inferred

### * Attempt to fit an alternative direction of K
* Log(L) = -13226.99, AIC-c = 26636.46 (91 estimated parameters)
* Relaxation/intensification parameter (K) =     1.00
* The following rate distribution was inferred for **test** branches

|          Selection mode           |     dN/dS     |Proportion, %|               Notes               |
|-----------------------------------|---------------|-------------|-----------------------------------|
|        Negative selection         |     0.122     |   88.463    |                                   |
|      Diversifying selection       |     3.624     |    3.312    |                                   |
|      Diversifying selection       |     5.924     |    8.225    |                                   |

* The following rate distribution was inferred for **reference** branches

|          Selection mode           |     dN/dS     |Proportion, %|               Notes               |
|-----------------------------------|---------------|-------------|-----------------------------------|
|        Negative selection         |     0.122     |   88.463    |                                   |
|      Diversifying selection       |     1.054     |    8.225    |                                   |
|      Diversifying selection       |     3.624     |    3.312    |                                   |


### Fitting the null (K := 1) model
* Log(L) = -13226.99, AIC-c = 26634.45 (90 estimated parameters)
* The following rate distribution for test/reference branches was inferred

|          Selection mode           |     dN/dS     |Proportion, %|               Notes               |
|-----------------------------------|---------------|-------------|-----------------------------------|
|        Negative selection         |     0.120     |   88.191    |                                   |
|      Diversifying selection       |     1.070     |    8.670    |                                   |
|      Diversifying selection       |     3.697     |    3.139    |                                   |

----
## Test for relaxation (or intensification) of selection [RELAX]
Likelihood ratio test **p =   0.7771**.
>No significant evidence for relaxation (or intensification) of selection among **test** branches _relative_ to the **reference** branches at P<=0.05
----


### Fitting the partitioned descriptive model (completely separate rate distributions for branch sets)
* Log(L) = -13226.95, AIC-c = 26642.41 (94 estimated parameters)
* The following rate distribution was inferred for *test* branches 

|          Selection mode           |     dN/dS     |Proportion, %|               Notes               |
|-----------------------------------|---------------|-------------|-----------------------------------|
|        Negative selection         |     0.501     |   75.191    |                                   |
|      Diversifying selection       |     1.094     |   18.054    |                                   |
|      Diversifying selection       |     2.106     |    6.755    |                                   |

* The following rate distribution was inferred for *reference* branches 

|          Selection mode           |     dN/dS     |Proportion, %|               Notes               |
|-----------------------------------|---------------|-------------|-----------------------------------|
|        Negative selection         |     0.121     |   88.215    |                                   |
|      Diversifying selection       |     1.054     |    8.645    |                                   |
|      Diversifying selection       |     3.724     |    3.140    |                                   |

